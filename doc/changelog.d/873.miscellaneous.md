Re-work allowed_types module to support multiple arguments
