[build-system]
requires = [
    "setuptools>=42",
    "wheel",
]
build-backend = "setuptools.build_meta"

[tool.tox]
legacy_tox_ini = """
[tox]
envlist = py36,py37,py38,py39,coverage
isolated_build = True

[gh-actions]
python =
    3.6: py36
    3.7: py37
    3.8: py38
    3.9: py39
    3.10: coverage

[testenv]
deps =
    ansys-openapi-common
    ansys-grantami-bomanalytics-openapi==0.1.0.dev12
    pytest
    pytest-cov
    requests-mock
    dataclasses; python_version < '3.7'
    lxml
    tabulate
    pandas
    ipython
install_command = pip install --pre --find-links ./deps {opts} {packages}
commands = pytest {posargs}
passenv =
    TEST_SL_URL
    TEST_USER
    TEST_PASS

[testenv:coverage]
deps = {[testenv]deps}
commands = pytest --cov=ansys.grantami.bomanalytics --cov-report=xml ./tests {posargs}

[testenv:lint]
deps =
    codespell==2.1.0
    flake8==3.9.2
    black
    mypy==0.910

commands =
    codespell ./src ./tests ./examples ./doc/source
    flake8 ./src ./tests ./examples
    black ./src ./tests --check
    mypy ./src
"""

[tool.mypy]
warn_return_any = true
warn_unused_configs = true
warn_redundant_casts = true
warn_unused_ignores = true
disallow_untyped_defs = true
no_implicit_optional = true
check_untyped_defs = true
show_error_codes = true

[tool.pytest.ini_options]
testpaths = "./tests"
markers = [
    """integration: test requires a real database (deselect with '-m \"not integration\"')"""
]

[tool.black]
line-length = 120
