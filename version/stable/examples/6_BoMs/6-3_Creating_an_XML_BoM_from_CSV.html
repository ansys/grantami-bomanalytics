
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta property="og:site_name" content="PyAnsys" />
    <title>Create an XML BoM from a CSV data source &#8212; PyGranta BoM Analytics 2.3.1</title>
  
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/ansys-sphinx-theme.css?v=ce7f2556" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/ansys-sphinx-theme.css?v=ce7f2556" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.23/css/jquery.dataTables.min.css" />
    <link rel="stylesheet" type="text/css" href="https://www.nerdfonts.com/assets/css/webfont.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/dataframe.css?v=1a040689" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>


  <!-- Include desired assets -->
  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  

  
    <link href="../../_static/css/breadcrumbs.css" rel="stylesheet" />
  
    <script src="../../_static/documentation_options.js?v=7de5c1a2"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=49e1bf35"></script>
    <script src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/6_BoMs/6-3_Creating_an_XML_BoM_from_CSV';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://bomanalytics.grantami.docs.pyansys.com/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '2.3';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <script src="../../_static/js/add_blank.js?v=f2ece54a"></script>
    <link rel="icon" href="../../_static/ansys-favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Contribute" href="../../contributing.html" />
    <link rel="prev" title="Create an XML BoM from a JSON data source" href="6-2_Creating_an_XML_BoM_from_JSON.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <link rel="canonical" href="https://bomanalytics.grantami.docs.pyansys.com/version/stable/examples/6_BoMs/6-3_Creating_an_XML_BoM_from_CSV.html" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/pyansys_logo_transparent_black.png" class="logo__image only-light" alt="PyGranta BoM Analytics 2.3.1 - Home"/>
    <script>document.write(`<img src="../../_static/pyansys_logo_transparent_white.png" class="logo__image only-dark" alt="PyGranta BoM Analytics 2.3.1 - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting_started/index.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user_guide/index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API reference
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contributing.html">
    Contribute
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../changelog.html">
    Release notes
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">
<div class="search-bar pst-js-only" id="search-bar">
  <form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
    <i class="fa-solid fa-magnifying-glass"></i>
    <input type="search" class="form-control" name="q" placeholder="Search the docs ..."
      aria-label="Search the docs ..." autocomplete="off" autocorrect="off"
      autocapitalize="off" spellcheck="false" />
    <span class="search-button__kbd-shortcut">
      <kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd>
    </span>
  </form>
  <div id="static-search-results" class="static-search-results" style="display:none;" tabindex="0"></div>
</div></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/grantami-bomanalytics" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  
  
    <div id="announcement_msg"></div>
<script>
  fetch("announcement.html")
    .then((response) => {
      if (!response.ok) {
        throw new Error(`HTTP error: ${response.status}`);
      }
      return response.text();
    })
    .then(
      (text) => (document.getElementById("announcement_msg").innerHTML = text),
    )
    .catch((error) => console.error(`Fetch problem: ${error.message}`));
</script>
  


  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting_started/index.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user_guide/index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API reference
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contributing.html">
    Contribute
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../changelog.html">
    Release notes
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<div class="search-bar pst-js-only" id="search-bar">
  <form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
    <i class="fa-solid fa-magnifying-glass"></i>
    <input type="search" class="form-control" name="q" placeholder="Search the docs ..."
      aria-label="Search the docs ..." autocomplete="off" autocorrect="off"
      autocapitalize="off" spellcheck="false" />
    <span class="search-button__kbd-shortcut">
      <kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd>
    </span>
  </form>
  <div id="static-search-results" class="static-search-results" style="display:none;" tabindex="0"></div>
</div></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/grantami-bomanalytics" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../0_Basic_usage.html">Basic usage example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1_Database-specific_configuration.html">Database-specific configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_Impacted_Substances_Queries/index.html">Impacted substances examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_Compliance_Queries/index.html">Compliance examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_Sustainability/index.html">Sustainability examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../5_Sustainability_summary/index.html">Sustainability summary examples</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">BoM examples</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="6-1_Creating_an_XML_BoM.html">Create an XML BoM using Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="6-2_Creating_an_XML_BoM_from_JSON.html">Create an XML BoM from a JSON data source</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Create an XML BoM from a CSV data source</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">
<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
         
    <li class="breadcrumb-item breadcrumb-home">
      <a href="https://docs.pyansys.com/" class="nav-link">PyAnsys</a>
    </li>
       
    <li class="breadcrumb-item">
      <a href="https://grantami.docs.pyansys.com/" class="nav-link">PyGranta</a>
    </li>
     
    <li class="breadcrumb-item">
      <a
        href="../../index.html"
        class="nav-link"
        aria-label="Home"
      >
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
     
    <li class="breadcrumb-item">
      <a href="../index.html" class="nav-link">Examples</a>
    </li>
     
    <li class="breadcrumb-item">
      <a href="index.html" class="nav-link">BoM examples</a>
    </li>
      
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Create an XML BoM from a CSV data source</span></li>
    
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p>Download this example as a <a class="reference download internal" download="" href="../../_downloads/24bcc93a001b9cc2615063d58fde5db0/6-3_Creating_an_XML_BoM_from_CSV.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Jupyter</span> <span class="pre">notebook</span></code></a> or a
<a class="reference download internal" download="" href="../../_downloads/9415e9b701ba4611b97886b56ab63672/6-3_Creating_an_XML_BoM_from_CSV.py"><code class="xref download docutils literal notranslate"><span class="pre">Python</span> <span class="pre">script</span></code></a>.</p>
<hr class="docutils" />
<section id="Create-an-XML-BoM-from-a-CSV-data-source">
<h1>Create an XML BoM from a CSV data source<a class="headerlink" href="#Create-an-XML-BoM-from-a-CSV-data-source" title="Link to this heading">#</a></h1>
<p>This example shows how to use the <code class="docutils literal notranslate"><span class="pre">bom_types</span></code> subpackage to create a Granta MI BoM. This subpackage can be used to help construct a Granta 24/12-compliant XML BoM file to use with the BoM queries provided by this package. The code in this example shows how to generate a BoM from a representative CSV data source. The general approach can be applied to data in other formats or provided by other APIs.</p>
<p>You can download the <a class="reference external" href="../supporting-files/glass_door.csv">CSV file</a> used in this example.</p>
<p>The result of this example is a Granta 24/12-compliant XML BoM file that is suitable for compliance or sustainability analysis with the Granta MI BoM Analytics API. For more information on the expected content of XML BoMs, see the Granta MI documentation.</p>
<section id="Load-the-external-data">
<h2>Load the external data<a class="headerlink" href="#Load-the-external-data" title="Link to this heading">#</a></h2>
<p>First load the CSV file and use <code class="docutils literal notranslate"><span class="pre">pandas</span></code> to load the content in a dataframe.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../supporting-files/glass_door.csv&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BoM Level</th>
      <th>ID</th>
      <th>Name</th>
      <th>Item Type</th>
      <th>Quantity</th>
      <th>Unit of measure</th>
      <th>Measured mass (per UoM)</th>
      <th>Measured mass unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>24X6-30</td>
      <td>24X6-30</td>
      <td>Part</td>
      <td>1.0</td>
      <td>Each</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>HA-42-Al</td>
      <td>HA-42-Al</td>
      <td>Part</td>
      <td>2.0</td>
      <td>Each</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>HA-42-Al(A)</td>
      <td>HA-42-Al(A)</td>
      <td>Part</td>
      <td>1.0</td>
      <td>Each</td>
      <td>146.0</td>
      <td>g/Part</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>aluminum-319-0-moldcast-t6</td>
      <td>Aluminum, 319.0, permanent mold cast, T6</td>
      <td>Material</td>
      <td>100.0</td>
      <td>%</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>HA-42-Al(B)</td>
      <td>HA-42-Al(B)</td>
      <td>Part</td>
      <td>1.0</td>
      <td>Each</td>
      <td>220.0</td>
      <td>g/Part</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Inspect-the-external-data">
<h2>Inspect the external data<a class="headerlink" href="#Inspect-the-external-data" title="Link to this heading">#</a></h2>
<p>The CSV file describes the bill of materials for the door assembly introduced in the <a class="reference internal" href="6-1_Creating_an_XML_BoM.html"><span class="doc">Creating an XML BoM</span></a> example. The door (24X6-30) contains two hinges (HA-42-Al) and a handle (H-S-BR-Dual), both fixed to the panel (P-30-L) with machine screws (DIN-7991-M8-20) and washers (N0403.12N.2). The door glass (321-51) is coated with a partially reflective polymer film (7000001298).</p>
<p>The hierarchy of items within the BoM is defined by the order of items in the CSV and the <code class="docutils literal notranslate"><span class="pre">BoM</span> <span class="pre">Level</span></code> column. If an item has the BoM level <em>n</em>, then the item’s parent is the first level preceding it in the CSV with a BoM level <em>n-1</em>.</p>
<p>Each item includes an <code class="docutils literal notranslate"><span class="pre">Item</span> <span class="pre">Type</span></code> column that identifies the type of the item, in this example the only values are <code class="docutils literal notranslate"><span class="pre">Part</span></code> or <code class="docutils literal notranslate"><span class="pre">Material</span></code>. Additional columns are specific to the type of item.</p>
<section id="Part-items">
<h3>Part items<a class="headerlink" href="#Part-items" title="Link to this heading">#</a></h3>
<p>Items that refer to parts only exist in the BoM and do not reference records in Granta MI. Their <code class="docutils literal notranslate"><span class="pre">Name</span></code> and <code class="docutils literal notranslate"><span class="pre">ID</span></code> are defined only in the BoM to identify parts.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> and <code class="docutils literal notranslate"><span class="pre">Unit</span> <span class="pre">of</span> <span class="pre">measure</span></code> columns describe the quantity of part expected in the parent. This can be done by specifying how many occurrences of a part are in an assembly, or for example for the glass door, the surface area of laminated glass.</p>
<p>There are three types of components in this example BoM:</p>
<ul class="simple">
<li><p>The product described by the BoM, whose <code class="docutils literal notranslate"><span class="pre">BoM</span> <span class="pre">Level</span></code> is <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p>Assemblies which are made of sub-parts.</p>
<ul>
<li><p>Their mass isn’t defined in the BoM because it can be computed by rolling up the mass of the sub-parts.</p></li>
</ul>
</li>
<li><p>Parts which are defined by their mass and the material they are made of.</p>
<ul>
<li><p>Their mass is defined via the <code class="docutils literal notranslate"><span class="pre">Measured</span> <span class="pre">mass</span> <span class="pre">(per</span> <span class="pre">UoM)</span></code> and <code class="docutils literal notranslate"><span class="pre">Measured</span> <span class="pre">mass</span> <span class="pre">unit</span></code>. The units for the mass must be consistent with the unit used to define the quantity of the part, so that when the quantity is multiplied with the mass per UoM, it resolves to a mass. For example, the quantity of glass panel included in the door is defined as a surface area <code class="docutils literal notranslate"><span class="pre">1.51</span> <span class="pre">m^2</span></code>, which requires the mass per unit of measure to be defined as a mass per surface area <code class="docutils literal notranslate"><span class="pre">19.6</span> <span class="pre">kg/m^2</span></code>.</p></li>
</ul>
</li>
</ul>
<p>For more information on the different options available for specifying part quantities and part masses, see the Granta MI documentation.</p>
</section>
<section id="Material-items">
<h3>Material items<a class="headerlink" href="#Material-items" title="Link to this heading">#</a></h3>
<p>Items that refer to materials correspond to records in Granta MI that contain the relevant compliance or sustainability information for these items. As a result, these items include both a human-readable <code class="docutils literal notranslate"><span class="pre">Name</span></code> column and an <code class="docutils literal notranslate"><span class="pre">ID</span></code> column. In this scenario, the system that provided the data source contains the Granta MI material assignments for each part based on the <code class="docutils literal notranslate"><span class="pre">Material</span> <span class="pre">ID</span></code> attribute, which is included in the <code class="docutils literal notranslate"><span class="pre">ID</span></code> column.</p>
<p>Materials are described in terms of percentage of the parent part made of the material.</p>
</section>
</section>
<section id="Build-the-BillsOfMaterials-object">
<h2>Build the <code class="docutils literal notranslate"><span class="pre">BillsOfMaterials</span></code> object<a class="headerlink" href="#Build-the-BillsOfMaterials-object" title="Link to this heading">#</a></h2>
<p>Import the <code class="docutils literal notranslate"><span class="pre">eco2412</span></code> sub-package and helper classes to build record and attribute references.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ansys.grantami.bomanalytics.bom_types</span> <span class="kn">import</span> <span class="n">eco2412</span><span class="p">,</span> <span class="n">AttributeReferenceBuilder</span><span class="p">,</span> <span class="n">RecordReferenceBuilder</span>

<span class="n">DB_KEY</span> <span class="o">=</span> <span class="s2">&quot;MI_Restricted_Substances&quot;</span>
<span class="n">TABLE_NAME</span> <span class="o">=</span> <span class="s2">&quot;MaterialUniverse&quot;</span>
</pre></div>
</div>
</div>
<p>Define a function that accepts a part row as input and returns a <code class="docutils literal notranslate"><span class="pre">eco2412.Part</span></code> object.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_part</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">eco2412</span><span class="o">.</span><span class="n">Part</span><span class="p">:</span>
    <span class="n">mass</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;Measured mass (per UoM)&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">mass</span><span class="p">):</span>
        <span class="n">mass_per_unit_of_measure</span> <span class="o">=</span> <span class="n">eco2412</span><span class="o">.</span><span class="n">UnittedValue</span><span class="p">(</span>
            <span class="n">value</span><span class="o">=</span><span class="n">mass</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;Measured mass unit&quot;</span><span class="p">],</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mass_per_unit_of_measure</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">eco2412</span><span class="o">.</span><span class="n">Part</span><span class="p">(</span>
        <span class="n">part_number</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">],</span>
        <span class="n">part_name</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">],</span>
        <span class="n">quantity</span><span class="o">=</span><span class="n">eco2412</span><span class="o">.</span><span class="n">UnittedValue</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;Quantity&quot;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;Unit of measure&quot;</span><span class="p">]),</span>
        <span class="n">mass_per_unit_of_measure</span><span class="o">=</span><span class="n">mass_per_unit_of_measure</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<p>Define a function that accepts a material row as input and returns a <code class="docutils literal notranslate"><span class="pre">eco2412.Material</span></code> object. Materials are identified by their attribute value <code class="docutils literal notranslate"><span class="pre">Material</span> <span class="pre">ID</span></code>, so the record reference is defined using a lookup value.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">material_id_reference</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">AttributeReferenceBuilder</span><span class="p">(</span><span class="n">DB_KEY</span><span class="p">)</span>
    <span class="o">.</span><span class="n">with_attribute_name</span><span class="p">(</span><span class="s2">&quot;Material ID&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">with_table_name</span><span class="p">(</span><span class="n">TABLE_NAME</span><span class="p">)</span>
    <span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">make_material</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">eco2412</span><span class="o">.</span><span class="n">Material</span><span class="p">:</span>
    <span class="n">unit</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;Unit of measure&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;%&quot;</span><span class="p">:</span>
        <span class="n">percentage</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;Quantity&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Method &#39;make_material&#39; only supports quantities defined as percentages.&quot;</span><span class="p">)</span>

    <span class="n">material_reference</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">RecordReferenceBuilder</span><span class="p">(</span><span class="n">db_key</span><span class="o">=</span><span class="n">DB_KEY</span><span class="p">)</span>
        <span class="o">.</span><span class="n">with_lookup_value</span><span class="p">(</span><span class="n">lookup_value</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">],</span> <span class="n">lookup_attribute_reference</span><span class="o">=</span><span class="n">material_id_reference</span><span class="p">)</span>
        <span class="o">.</span><span class="n">build</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">eco2412</span><span class="o">.</span><span class="n">Material</span><span class="p">(</span>
        <span class="n">mi_material_reference</span><span class="o">=</span><span class="n">material_reference</span><span class="p">,</span>
        <span class="n">identity</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">],</span>
        <span class="n">percentage</span><span class="o">=</span><span class="n">percentage</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<p>Iterate over the rows in the CSV file and convert to <code class="docutils literal notranslate"><span class="pre">bom_types</span></code> objects. Because items only ever appear after their parent, a list is used to keep track of possible parent items in the BoM.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiate the hierarchy with an empty BoM object</span>
<span class="n">bom</span> <span class="o">=</span> <span class="n">eco2412</span><span class="o">.</span><span class="n">BillOfMaterials</span><span class="p">(</span><span class="n">components</span><span class="o">=</span><span class="p">[])</span>
<span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="n">bom</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">item_row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">item_level</span> <span class="o">=</span> <span class="n">item_row</span><span class="p">[</span><span class="s2">&quot;BoM Level&quot;</span><span class="p">]</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="n">item_level</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">item_type</span> <span class="o">=</span> <span class="n">item_row</span><span class="p">[</span><span class="s2">&quot;Item Type&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s2">&quot;Part&quot;</span><span class="p">:</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">make_part</span><span class="p">(</span><span class="n">item_row</span><span class="p">)</span>
        <span class="n">parent</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s2">&quot;Material&quot;</span><span class="p">:</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">make_material</span><span class="p">(</span><span class="n">item_row</span><span class="p">)</span>
        <span class="n">parent</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported &#39;Item Type&#39;: &#39;</span><span class="si">{</span><span class="n">item_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="c1"># Update the hierarchy with the newly created item</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">[:</span><span class="n">item_level</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">item</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
<section id="Serialize-the-BoM">
<h2>Serialize the BoM<a class="headerlink" href="#Serialize-the-BoM" title="Link to this heading">#</a></h2>
<p>Use the <code class="docutils literal notranslate"><span class="pre">BomHandler</span></code> helper class to serialize the object to XML. The resulting string can be used in a BoM query.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ansys.grantami.bomanalytics</span> <span class="kn">import</span> <span class="n">BoMHandler</span>
<span class="n">bom_as_xml</span> <span class="o">=</span> <span class="n">BoMHandler</span><span class="p">()</span><span class="o">.</span><span class="n">dump_bom</span><span class="p">(</span><span class="n">bom</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bom_as_xml</span><span class="p">[:</span><span class="mi">500</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;ns0:PartsEco xmlns:ns0=&#34;http://www.grantadesign.com/24/12/BillOfMaterialsEco&#34; xmlns:ns1=&#34;http://www.grantadesign.com/12/05/GrantaBaseTypes&#34;&gt;
    &lt;ns0:Components&gt;
        &lt;ns0:Part&gt;
            &lt;ns0:Quantity Unit=&#34;Each&#34;&gt;1.0&lt;/ns0:Quantity&gt;
            &lt;ns0:PartNumber&gt;24X6-30&lt;/ns0:PartNumber&gt;
            &lt;ns0:Name&gt;24X6-30&lt;/ns0:Name&gt;
            &lt;ns0:Components&gt;
                &lt;ns0:Part&gt;
                    &lt;ns0:Quantity Unit=&#34;Each&#34;&gt;2.0&lt;/ns0:Quantity&gt;
                    &lt;ns0:PartNumber&gt;HA-42-Al&lt;/...
</pre></div></div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Load-the-external-data">Load the external data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Inspect-the-external-data">Inspect the external data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Part-items">Part items</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Material-items">Material items</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Build-the-BillsOfMaterials-object">Build the <code class="docutils literal notranslate"><span class="pre">BillsOfMaterials</span></code> object</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Serialize-the-BoM">Serialize the BoM</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
<!-- If there is no fix edit button function, use the PyData edit-this-button-->
</div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <ul class="this-page-menu">
      <li><a href="../../_sources/examples/6_BoMs/6-3_Creating_an_XML_BoM_from_CSV.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>


  <!-- Include desired assets -->
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.7/require.min.js"></script>

<script>
// Passing the search options to the search.js file
const SEARCH_OPTIONS = JSON.parse('{"keys": ["title", "text", "objectID"], "limit": 10, "threshold": 0.2}');
const SEARCH_FILE = "../../_static/search.json";
const ADVANCE_SEARCH_PATH = "../../search.html";
const EXTRA_SOURCES = JSON.parse('""');
</script>


<script src="../../_static/js/search.js"></script>

  
  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright (c) 2025 ANSYS, Inc. All rights reserved.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the
  <a href="https://sphinxdocs.ansys.com/version/stable/index.html"
    >Ansys Sphinx Theme</a
  >
  1.5.3. <br />Last updated on
  <span id="ast_build_date"></span>
</p>
<script>
  var options = { day: "numeric", month: "long", year: "numeric" };
  var ast_lastModifiedDate = new Date(document.lastModified);
  var ast_build_date = ast_lastModifiedDate.toLocaleDateString("en-US", options);
  document.getElementById("ast_build_date").innerHTML = ast_build_date;
</script></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>